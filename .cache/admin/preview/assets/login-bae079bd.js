import{w as p,cY as y,a as e,j as r,B as h,r as l,cZ as S,y as N,F as E}from"./index-2d41eb72.js";import{i as x,d as f,g as v,u as z}from"./index-8af7b54a.js";import{S as u,P as C}from"./login-layout-f4acb1af.js";import{F}from"./index-dfcee5d3.js";import{C as L}from"./index-281c90b3.js";import{S as P}from"./index-9ec7a1b4.js";const R=({toResetPassword:o})=>{const{register:s,handleSubmit:t,setError:a,formState:{errors:i}}=x(),n=p(),{mutate:c,isLoading:m}=y();return e("form",{onSubmit:t(d=>{c(d,{onSuccess:()=>{n("/a/orders")},onError:()=>{a("password",{type:"manual",message:"These credentials do not match our records."},{shouldFocus:!0})}})}),children:r("div",{className:"flex flex-col items-center",children:[e("h1",{className:"inter-xlarge-semibold text-grey-90 mb-large text-[20px]",children:"Log in to Medusa"}),r("div",{children:[e(u,{placeholder:"Email",...s("email",{required:!0}),autoComplete:"email",className:"mb-small"}),e(u,{placeholder:"Password",type:"password",...s("password",{required:!0}),autoComplete:"current-password",className:"mb-xsmall"}),e(f,{errors:i,name:"password"})]}),e(h,{className:"rounded-rounded inter-base-regular mt-4 w-[280px]",variant:"secondary",size:"medium",type:"submit",loading:m,children:"Continue"}),e("span",{className:"inter-small-regular text-grey-50 mt-8 cursor-pointer",onClick:o,children:"Forgot your password?"})]})})},Z=new RegExp("^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$"),A=({goBack:o})=>{const[s,t]=l.useState(!1),{register:a,handleSubmit:i,formState:{errors:n}}=x(),{mutate:c,isLoading:m}=S(),g=z(),d=i(w=>{c({email:w.email},{onSuccess:()=>{t(!0)},onError:b=>{g("Error",v(b),"error")}})});return e("form",{onSubmit:d,children:r("div",{className:"flex flex-col items-center",children:[e("h1",{className:"inter-xlarge-semibold text-grey-90 mb-xsmall text-[20px]",children:"Reset your password"}),r("span",{className:"inter-base-regular text-grey-50 mb-large text-center",children:["Enter your email address below, and we'll",e("br",{}),"send you instructions on how to reset",e("br",{}),"your password."]}),s?r("div",{className:"text-grey-60 rounded-rounded bg-grey-5 border-grey-20 p-base gap-x-small flex w-[280px] items-center border",children:[e("div",{children:e(L,{className:"text-blue-50",size:20})}),e("div",{className:"gap-y-2xsmall flex flex-col",children:e("span",{className:"inter-base-regular",children:"Succesfully sent you an email"})})]}):r(N,{children:[r("div",{className:"w-[280px]",children:[e(u,{placeholder:"Email",...a("email",{required:F.required("Email"),pattern:{value:Z,message:"This is not a valid email"}})}),e(f,{errors:n,name:"email"})]}),e(h,{variant:"secondary",size:"medium",className:"mt-large w-[280px]",type:"submit",loading:m,children:"Send reset instructions"})]}),e("span",{className:"inter-small-regular text-grey-50 mt-8 cursor-pointer",onClick:o,children:"Go back to sign in"})]})})},T=()=>{const[o,s]=l.useState(!1),{user:t}=E(),a=p();return l.useEffect(()=>{t&&a("/")},[t,a]),l.useEffect(()=>{window.location.search.includes("reset-password")&&s(!0)},[]),r(C,{children:[e(P,{title:"Login"}),o?e(A,{goBack:()=>{s(!1),a("/login",{replace:!0})}}):e(R,{toResetPassword:()=>{s(!0)}})]})};export{T as default};
